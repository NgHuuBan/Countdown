<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Countdown Server Minecraft</title>
  <style>
    body {
      font-family: monospace;
      background: #111;
      color: #0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
    }
    p {
      font-size: 1.2rem;
      color: #ccc;
    }
  </style>
</head>
<body>
  <h1 id="countdown">‚è≥ ƒêang t·∫£i...</h1>
  <p id="status"></p>

  <script>
    const TIMEOUT = 13500; // 3h45p = 13500 gi√¢y
    const startUrl = "https://raw.githubusercontent.com/NgHuuBan/Countdown/main/start.json";
    const stopUrl = "https://raw.githubusercontent.com/NgHuuBan/Countdown/main/stop.json";

    async function fetchJson(url) {
      const res = await fetch(url + "?t=" + Date.now()); // tr√°nh cache
      if (!res.ok) throw new Error("Kh√¥ng t√¨m th·∫•y " + url);
      return res.json();
    }

    async function loadCountdown() {
      try {
        const stopData = await fetchJson(stopUrl);
        if (stopData && stopData.stop) {
          document.getElementById("countdown").textContent = "üõë Server ƒë√£ d·ª´ng.";
          const d = new Date(stopData.stop * 1000);
          document.getElementById("status").textContent = "Th·ªùi gian d·ª´ng: " + d.toLocaleString();
          return;
        }
      } catch (err) {
        // Kh√¥ng c√≥ stop.json ‚Üí ti·∫øp t·ª•c
      }

      try {
        const startData = await fetchJson(startUrl);
        const start = startData.start;
        const endTime = start + TIMEOUT;

        function updateClock() {
          const now = Math.floor(Date.now() / 1000);
          const remaining = endTime - now;

          if (remaining <= 0) {
            document.getElementById("countdown").textContent = "‚è∞ ƒê√£ h·∫øt gi·ªù!";
            document.getElementById("status").textContent = "";
            return;
          }

          const h = Math.floor(remaining / 3600);
          const m = Math.floor((remaining % 3600) / 60);
          const s = remaining % 60;

          document.getElementById("countdown").textContent =
            `‚è≥ C√≤n l·∫°i: ${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        updateClock();
        setInterval(updateClock, 1000);
        document.getElementById("status").textContent = "Server ƒëang ch·∫°y...";
      } catch (err) {
        document.getElementById("countdown").textContent = "‚ö† Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu.";
      }
    }

    window.onload = loadCountdown;
  </script>
</body>
</html>
